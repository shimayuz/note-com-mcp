# note MCP Server セットアップ指示書

## 重要: このファイルを最初に読むこと

ユーザーが「セットアップして」「設定して」「インストールして」「使えるようにして」と言ったら、以下の手順を**すべて順番に実行**してください。

---

## セットアップ手順（必ずこの順番で実行）

### Step 1: Node.js確認

```bash
node --version
```

**v18未満またはエラーの場合は停止して以下を案内：**
- Mac: `brew install node`
- Windows: https://nodejs.org/ からダウンロード

---

### Step 2: npmパッケージインストール

```bash
npm install
```

**エラー時：**
```bash
npm cache clean --force
rm -rf node_modules package-lock.json
npm install
```

---

### Step 3: Playwrightインストール

```bash
npx playwright install
```

---

### Step 4: ビルド

```bash
npm run build
```

**確認：**
```bash
ls build/note-mcp-server.js
```

ファイルが存在すればOK。

---

### Step 5: プロジェクトパス取得

```bash
pwd
```

この出力を覚えておく（例: `/Users/username/note-com-mcp`）

---

### Step 6: OS判定

```bash
uname -s 2>/dev/null || echo "Windows"
```

- `Darwin` → Mac
- `Linux` → Linux  
- `Windows` または MINGW → Windows

---

### Step 7: MCP設定ファイル作成

#### Macの場合

```bash
mkdir -p ~/.cursor
```

以下の内容で `~/.cursor/mcp.json` を作成：

```json
{
  "mcpServers": {
    "note-api": {
      "command": "node",
      "args": ["ここにStep5のパス/build/note-mcp-server.js"]
    }
  }
}
```

**重要: `ここにStep5のパス` を実際のパスに置き換える**

#### Windowsの場合

以下の内容で `%USERPROFILE%\.cursor\mcp.json` を作成：

```json
{
  "mcpServers": {
    "note-api": {
      "command": "node",
      "args": ["C:\\Users\\ユーザー名\\note-com-mcp\\build\\note-mcp-server.js"]
    }
  }
}
```

**重要: パスを実際の値に置き換える。バックスラッシュは `\\` でエスケープ**

---

### Step 8: 動作確認

```bash
npm run start
```

- ブラウザが開いたらnote.comにログイン
- ログイン後、自動でセッション取得
- `Ctrl+C` で終了

---

### Step 9: 完了報告

以下のように報告する：

```
◤◢◤◢◤◢◤◢◤◢◤◢◤◢
✅ セットアップ完了！

次のステップ：
1. Cursorを再起動してください
2. 「noteで記事を検索して」と試してください

認証について：
初回はブラウザが開くのでnote.comにログインしてください
◤◢◤◢◤◢◤◢◤◢◤◢◤◢
```

---

## トラブルシューティング

### npm install失敗
```bash
npm cache clean --force
rm -rf node_modules package-lock.json
npm install
```

### playwright install失敗
```bash
npx playwright install-deps
npx playwright install
```

### build失敗
```bash
rm -rf node_modules
npm install
npm run build
```

---

## コマンド早見表

| 目的 | コマンド |
|------|---------|
| インストール | `npm install` |
| ビルド | `npm run build` |
| 起動 | `npm run start` |
| HTTP起動 | `npm run start:http` |

---

## 注意事項

- 各Stepでエラーが出たら次に進まず、まずエラーを解決する
- MCP設定のパスは絶対パスで指定する
- Windowsのパスはバックスラッシュを `\\` でエスケープする
- セットアップ完了後は必ずCursorを再起動する
